{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport function renderImages(result) {\n  return result.hits\n    .map(\n      ({\n        webformatURL,\n        tags,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return ` <li>\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${webformatURL}\" \n        alt=\"${tags}\"\n        data-source=\"${largeImageURL}\">\n        <div class=\"image-info\">\n                            <ul class=\"image-info-list\">\n                                <li class=\"image-item\">\n                                    <h2 class=\"image-text\">Likes</h2>\n                                    <p class=\"image-quantity\">${likes}</p>\n                                </li>\n                                <li class=\"image-item\">\n                                    <h2 class=\"image-text\">Views</h2>\n                                    <p class=\"image-quantity\">${views}</p>\n                                </li>\n                                <li class=\"image-item\">\n                                    <h2 class=\"image-text\">Comments</h2>\n                                    <p class=\"image-quantity\">${comments}</p>\n                                </li>\n                                <li class=\"image-item\">\n                                    <h2 class=\"image-text\">Downloads</h2>\n                                    <p class=\"image-quantity\">${downloads}</p>\n                                </li>\n                            </ul>\n                        </div>\n      </li>`;\n      }\n    )\n    .join('');\n}\n\nexport function initializeLightbox() {\n  return new SimpleLightbox('.gallery-link', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n","import axios from 'axios';\nexport const limit = 15;\n\nexport async function fetchIcon(query, page) {\n  const params = new URLSearchParams({\n    key: '42717208-a054428a9fe92ed44706731cd',\n    q: query,\n    per_page: limit,\n    page: page,\n  });\n\n  const BASE_URL = 'https://pixabay.com/api/';\n  const response = await axios.get(`${BASE_URL}?${params}`);\n\n  return {\n    hits: response.data.hits,\n    totalHits: response.data.totalHits,\n  };\n}\n","import { renderImages, initializeLightbox } from './js/render-functions.js';\nimport { fetchIcon, limit } from './js/pixabay-api';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst button = document.querySelector('.load-more');\nlet lightbox;\nlet page = 1;\nlet prevQuery = '';\nlet currentPage = 1;\n\nform.addEventListener('submit', onSubmit);\nbutton.addEventListener('click', loadMore);\n\nfunction onSubmit(e) {\n  e.preventDefault();\n  const query = form.elements['search'].value;\n\n  currentPage = page;\n  if (query !== prevQuery) {\n    page = 1;\n    prevQuery = query;\n  }\n\n  gallery.innerHTML = '';\n  loader.style.display = 'block';\n  button.style.display = 'none';\n\n  fetchImages(query, page);\n\n  form.reset();\n}\n\nfunction loadMore() {\n  loader.style.display = 'block';\n  page += 1;\n\n  if (page === currentPage + 1) {\n    fetchImages(prevQuery, page);\n  } else {\n    console.log('Стoрінка була змінена перед завершенням попереднього запиту.');\n  }\n}\n\nasync function fetchImages(query, page) {\n  try {\n    const data = await fetchIcon(query, page);\n\n    if (!query.trim()) {\n      iziToast.error({\n        message: 'Заповніть це поле!',\n        messageColor: '#FFFFFF',\n        backgroundColor: '#B51B1B',\n        position: 'topRight',\n      });\n      loader.style.display = 'none';\n      return;\n    } else if (data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        messageColor: '#FFFFFF',\n        backgroundColor: '#B51B1B',\n        position: 'center',\n      });\n      loader.style.display = 'none';\n      return;\n    } else {\n      const imagesHTML = renderImages(data);\n      gallery.insertAdjacentHTML('beforeend', imagesHTML);\n      loader.style.display = 'none';\n      if (!lightbox) {\n        lightbox = initializeLightbox();\n      } else {\n        lightbox.refresh();\n      }\n      scroll();\n      currentPage = page;\n      const totalImages = data.totalHits;\n      const totalPages = Math.ceil(totalImages / limit);\n      if (page >= totalPages) {\n        button.style.display = 'none';\n        return iziToast.error({\n          position: 'topRight',\n          message: \"We're sorry, there are no more images to load\",\n        });\n      } else {\n        button.style.display = 'block';\n      }\n    }\n  } catch (error) {\n    loader.style.display = 'none';\n    iziToast.error({\n      message: 'Fetch error. Please try again later.',\n      messageColor: '#FFFFFF',\n      backgroundColor: '#B51B1B',\n      position: 'center',\n    });\n  }\n}\n\nfunction scroll() {\n  const cardHeight = gallery.firstElementChild.getBoundingClientRect().height;\n  window.scrollBy({ top: 2 * cardHeight, behavior: 'smooth' });\n}\n"],"names":["renderImages","result","webformatURL","tags","largeImageURL","likes","views","comments","downloads","initializeLightbox","SimpleLightbox","limit","fetchIcon","query","page","params","BASE_URL","response","axios","form","gallery","loader","button","lightbox","prevQuery","currentPage","onSubmit","loadMore","e","fetchImages","data","iziToast","imagesHTML","scroll","totalImages","totalPages","cardHeight"],"mappings":"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"}